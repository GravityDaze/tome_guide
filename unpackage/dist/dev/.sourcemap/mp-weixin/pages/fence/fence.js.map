{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/11632/Desktop/project/tome_guide/pages/fence/fence.vue?9c01","webpack:///C:/Users/11632/Desktop/project/tome_guide/pages/fence/fence.vue?5eac","webpack:///C:/Users/11632/Desktop/project/tome_guide/pages/fence/fence.vue?37f7","webpack:///C:/Users/11632/Desktop/project/tome_guide/pages/fence/fence.vue?554e","uni-app:///pages/fence/fence.vue","webpack:///C:/Users/11632/Desktop/project/tome_guide/pages/fence/fence.vue?f9ca","webpack:///C:/Users/11632/Desktop/project/tome_guide/pages/fence/fence.vue?4579"],"names":["createPage","Page"],"mappings":"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","file":"pages/fence/fence.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/fence/fence.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./fence.vue?vue&type=template&id=98bf492c&scoped=true&\"\nvar renderjs\nimport script from \"./fence.vue?vue&type=script&lang=js&\"\nexport * from \"./fence.vue?vue&type=script&lang=js&\"\nimport style0 from \"./fence.vue?vue&type=style&index=0&id=98bf492c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"98bf492c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/fence/fence.vue\"\nexport default component.exports","export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./fence.vue?vue&type=template&id=98bf492c&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.warnTypeMap.get(_vm.fenceInfo.warnType)\n  var g1 = _vm.remindTypeMap.get(_vm.fenceInfo.remindType)\n  var g2 = _vm.statusMap.get(_vm.fenceInfo.status)\n\n  var m0 = require(\"../../static/\" +\n    (_vm.addMode ? \"清除\" : \"新建\") +\n    \"@2x.png\")\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        m0: m0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./fence.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./fence.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"fence\">\r\n\t\t<swiper class=\"swiper\" v-if=\"!addMode && showPanel\">\r\n\t\t\t<swiper-item>\r\n\t\t\t\t<view class=\"swiper-item\">\r\n\t\t\t\t\t<view class=\"num\">\r\n\t\t\t\t\t\t{{ '0' + (curIndex+1) }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"desc\">\r\n\t\t\t\t\t\t<view class=\"title\">{{ fenceInfo.name }}</view>\r\n\t\t\t\t\t\t<view class=\"tips\">\r\n\t\t\t\t\t\t\t<view>触发方式：{{warnTypeMap.get(fenceInfo.warnType)}}</view>\r\n\t\t\t\t\t\t\t<view>提醒方式：{{remindTypeMap.get(fenceInfo.remindType)}}</view>\r\n\t\t\t\t\t\t\t<view :style=\"{ color:fenceInfo.status === 0 ? 'red':'#999896' }\">当前状态：{{statusMap.get(fenceInfo.status)}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"btn\">\r\n\t\t\t\t\t\t\t<view class=\"enable\" @click=\"changeFenceStatus\">\r\n\t\t\t\t\t\t\t\t<image src=\"../../static/启用@2x.png\" mode=\"\"></image>\r\n\t\t\t\t\t\t\t\t{{ fenceInfo.status===0?'启用':'禁用' }}\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<view class=\"delete\" @click=\"delFence\">\r\n\t\t\t\t\t\t\t\t<image src=\"../../static/删除@2x.png\" mode=\"\"></image>\r\n\t\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t</view>\r\n\t\t\t</swiper-item>\r\n\t\t</swiper>\r\n\t\t\r\n\t\t<map id=\"map\" :latitude=\"latitude\" :longitude=\"longitude\" :polygons=\"polygons\" :polyline=\"polyline\" @tap=\"drawPolyline\" :markers=\"markers\" @markertap=\"closeLine\"></map>\r\n\t\t\r\n\t\t<!-- 新增围栏按钮 -->\r\n\t\t<view class=\"add-fench\" @click=\"addFench\">\r\n\t\t\t<image :src=\"require(`../../static/${addMode?'清除':'新建'}@2x.png`)\" mode=\"\"></image>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 新增围栏面板 -->\r\n\t\t<view class=\"add-panel\" v-if=\"addMode\">\r\n\t\t\t<view class=\"title\">\r\n\t\t\t\t<input type=\"text\" value=\"\" placeholder=\"请输入围栏标题\" placeholder-class=\"phcolor\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"type\">\r\n\t\t\t\t<view class=\"warn-type\" @click=\"chooseWarnType\">\r\n\t\t\t\t\t请选择触发条件\r\n\t\t\t\t\t<image src=\"../../static/icon-shaixuan@2x.png\" mode=\"\"></image>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"remind-type\" @click=\"chooseRemindType\">\r\n\t\t\t\t\t请选择提醒方式\r\n\t\t\t\t\t<image src=\"../../static/icon-shaixuan@2x.png\" mode=\"\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 保存围栏 -->\r\n\t\t<view class=\"save-fence\" @click=\"saveFence\" v-if=\"addMode\">\r\n\t\t\t保存\r\n\t\t</view>\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tqueryFence,\r\n\t\tcreateFence,\r\n\t\tdisableFence,\r\n\t\tenableFnece\r\n\t} from '@/api/api.js'\r\n\timport {\r\n\t\tgetLatLngCenter\r\n\t} from '@/utils/getLatLngCenter.js'\r\n\timport {\r\n\t\tisPolygon\r\n\t} from '@/utils/polygon.js'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid:0, //自定义绘制围栏marker的id\r\n\t\t\t\tallowDrawing:false, // 是否允许在地图上绘制polyline\r\n\t\t\t\tshowPanel: false,  //是否展示电子围栏面板\r\n\t\t\t\tpageType: '', // 页面参数 'read' => 导游从'景区围栏'选项进入 , 'edit' => 导游从'自定义围栏'选项进入\r\n\t\t\t\taddMode: false, // 是否处于新增或编辑电子围栏模式\r\n\t\t\t\tpolygons: [], \r\n\t\t\t\tpolyline:[],\r\n\t\t\t\tmarkers:[],\r\n\t\t\t\tfenceInfo: {}, //从服务器查询到的电子围栏信息\r\n\t\t\t\tlatitude: '', \r\n\t\t\t\tlongitude: '',\r\n\t\t\t\tcurIndex: 0, //当前展示的电子围栏的swiper索引\r\n\t\t\t\twarnTypeMap: new Map([\r\n\t\t\t\t\t[1, \"出围栏报警\"],\r\n\t\t\t\t\t[2, \"进围栏报警\"],\r\n\t\t\t\t\t[3, \"进出围栏报警\"]\r\n\t\t\t\t]),\r\n\t\t\t\tremindTypeMap: new Map([\r\n\t\t\t\t\t[0, \"不提示\"],\r\n\t\t\t\t\t[1, \"振动\"],\r\n\t\t\t\t\t[2, \"语音\"],\r\n\t\t\t\t\t[3, \"语音+震动\"]\r\n\t\t\t\t]),\r\n\t\t\t\tstatusMap: new Map([\r\n\t\t\t\t\t[0, \"禁用\"],\r\n\t\t\t\t\t[1, \"启用\"],\r\n\t\t\t\t\t[9, \"删除\"]\r\n\t\t\t\t])\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tthis.getFence()\r\n\t\t\tthis.pageType = options.type\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync getFence() {\r\n\t\t\t\tconst res = await queryFence({\r\n\t\t\t\t\timei: 'd',\r\n\t\t\t\t\tsceneryNo: 'S0001'\r\n\t\t\t\t})\r\n\t\t\t\tif (!res.value.list || !res.value.list.length) {\r\n\t\t\t\t\t// 不存在景区围栏时, 返回导游当前的位置\r\n\t\t\t\t\tthis.latitude = getApp().globalData.latitude\r\n\t\t\t\t\tthis.longitude = getApp().globalData.longitude\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: '没有找到景区围栏',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tconst fence = res.value.list[this.curIndex]\r\n\t\t\t\t// 显示景区围栏面板\r\n\t\t\t\tthis.showPanel = true\r\n\t\t\t\tthis.fenceInfo = {\r\n\t\t\t\t\tid: fence.id, // 围栏id\r\n\t\t\t\t\tname: fence.name, //围栏名\r\n\t\t\t\t\twarnType: fence.warnType, //触发条件 \r\n\t\t\t\t\tremindType: fence.remindType, //提醒方式\r\n\t\t\t\t\tstatus: fence.status //当前状态\r\n\t\t\t\t}\r\n\t\t\t\t// 获取到经纬度数组\r\n\t\t\t\tconst latLng = res.value.list.map(v => {\r\n\t\t\t\t\tconst points = v.scope.split(';')\r\n\t\t\t\t\tpoints.pop()\r\n\t\t\t\t\t// 将获得的经纬度数组转换为浮点数\r\n\t\t\t\t\tconst floatPoint = points.map(v => v.split(',').map(v => parseFloat(v)))\r\n\t\t\t\t\t// 交换经纬度\r\n\t\t\t\t\treturn floatPoint.map(v => [v[1], v[0]])\r\n\t\t\t\t}).flat()\r\n\t\t\t\t// 获取到中心经纬度\r\n\t\t\t\tthis.latitude = getLatLngCenter(latLng)[0]\r\n\t\t\t\tthis.longitude = getLatLngCenter(latLng)[1]\r\n\t\t\t\t// 生成闭合多边形\r\n\t\t\t\tconst points = latLng.map(v => ({\r\n\t\t\t\t\tlatitude: v[0],\r\n\t\t\t\t\tlongitude: v[1]\r\n\t\t\t\t}))\r\n\t\t\t\tthis.polygons.push({\r\n\t\t\t\t\tpoints,\r\n\t\t\t\t\tstrokeColor: \"#0DC392\",\r\n\t\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\t\tfillColor: \"#07C28F26\"\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 新增围栏\r\n\t\t\taddFench() {\r\n\t\t\t\tthis.addMode = !this.addMode\r\n\t\t\t\tthis.allowDrawing = this.addMode\r\n\t\t\t\t!this.addMode && this.clearMapCover()\r\n\t\t\t},\r\n\r\n\t\t\t// 改变围栏状态\r\n\t\t\tasync changeFenceStatus() {\r\n\t\t\t\tif (this.fenceInfo.status === 0) {\r\n\t\t\t\t\t// 启用电子围栏\r\n\t\t\t\t\tconst res = await enableFence({\r\n\t\t\t\t\t\tid: this.fenceInfo.id\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.fenceInfo.status = 1\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst res = await disableFence({\r\n\t\t\t\t\t\tid: this.fenceInfo.id\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.fenceInfo.status = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 选择报警方式\r\n\t\t\tchooseWarnType(){\r\n\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\t itemList: ['出围栏报警', '进围栏报警', '进出围栏报警'],\r\n\t\t\t\t\t success: ({tapIndex}) => {\r\n\t\t\t\t\t\t// this.userInfo.sex = tapIndex\r\n\t\t\t\t\t }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 选择提醒类型\r\n\t\t\tchooseRemindType(){\r\n\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\t itemList: ['不提示', '震动', '语音','语音+震动'],\r\n\t\t\t\t\t success: ({tapIndex}) => {\r\n\t\t\t\t\t\t// this.userInfo.sex = tapIndex\r\n\t\t\t\t\t }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 清除地图上所有标记物\r\n\t\t\tclearMapCover(){\r\n\t\t\t\tthis.polygons = []\r\n\t\t\t\tthis.polyline = []\r\n\t\t\t\tthis.markers = []\r\n\t\t\t\tthis.id = 0 \r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 绘制围栏\r\n\t\t\tdrawPolyline(e){\r\n\t\t\t\tif(!this.allowDrawing) return\r\n\t\t\t\t\r\n\t\t\t\t// 点击地图时 在地图上创建marker\r\n\t\t\t\tconst { latitude, longitude } = e.detail\r\n\t\t\t\tthis.markers.push({\r\n\t\t\t\t\tid:this.id++,\r\n\t\t\t\t\tlatitude,\r\n\t\t\t\t\tlongitude,\r\n\t\t\t\t\ticonPath:'/static/定位@2x.png'\r\n\t\t\t\t})\r\n\t\t\t\t// 根据marker的坐标绘制polyline\r\n\t\t\t\tconst points = this.markers.map( v=>({\r\n\t\t\t\t\tlatitude:v.latitude,\r\n\t\t\t\t\tlongitude:v.longitude\r\n\t\t\t\t}) )\r\n\t\t\t\tthis.polyline = [{\r\n\t\t\t\t\tpoints,\r\n\t\t\t\t\twidth:2,\r\n\t\t\t\t\tcolor:'#0DC392',\r\n\t\t\t\t\tdottedLine:true\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 点击第一个marker时将polyline闭合为polygon\r\n\t\t\tcloseLine(e){\r\n\t\t\t\tif(!this.allowDrawing) return\r\n\t\t\t\tif( e.markerId !== 0 ){\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:'请选择第一个标记进行闭合',\r\n\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst points = this.markers.map( v=>({\r\n\t\t\t\t\t\tlatitude:v.latitude,\r\n\t\t\t\t\t\tlongitude:v.longitude\r\n\t\t\t\t\t}) )\r\n\t\r\n\t\t\t\t\tif( points.length <= 2 ){\r\n\t\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\t\ttitle:'请至少绘制三个点',\r\n\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 判断绘制出来的是否是规则多边形\r\n\t\t\t\t\tif( !isPolygon(points)){\r\n\t\t\t\t\t\tthis.clearMapCover()\r\n\t\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\t\ttitle:'请绘制规则的多边形',\r\n\t\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 形成闭合多边形\r\n\t\t\t\t\tthis.polygons = [{\r\n\t\t\t\t\t\tpoints,\r\n\t\t\t\t\t\tstrokeColor: \"#0DC392\",\r\n\t\t\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\t\t\tfillColor: \"#07C28F26\"\r\n\t\t\t\t\t}]\r\n\t\t\t\t\t// 清除polyLine\r\n\t\t\t\t\tthis.polyline = []\r\n\t\t\t\t\tthis.markers = []\r\n\t\t\t\t\tthis.id = 0 \r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:'电子围栏绘制成功',\r\n\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.allowDrawing = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 创建围栏\r\n\t\t\tasync saveFence(){\r\n\t\t\t\tconst res = await createFence({\r\n\t\t\t\t\tsceneryNo: \"S0001\",\r\n\t\t\t\t\tname: \"测试围栏\",\r\n\t\t\t\t\tscope:\"103.57289155100398_30.91334920379188,103.57642189165819_30.913597063584852\",\r\n\t\t\t\t\twarnType:1,\r\n\t\t\t\t\tremindType:1\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t}\r\n\t\t\t \r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.fence {\r\n\t\t.swiper {\r\n\t\t\tposition: fixed;\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t\tz-index: 99;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 500rpx;\r\n\r\n\t\t\t.swiper-item {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tpadding-bottom: 60rpx;\r\n\t\t\t\twidth: 700rpx;\r\n\t\t\t\tmargin: auto;\r\n\t\t\t\tbox-shadow: 0px 1rpx 23rpx 1rpx rgba(36, 36, 35, 0.08);\r\n\t\t\t\tborder-radius: 30rpx;\r\n\t\t\t\tbackground: #fff;\r\n\r\n\t\t\t\t.num {\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\ttop: 30rpx;\r\n\t\t\t\t\tleft: 16rpx;\r\n\t\t\t\t\tfont-size: 86rpx;\r\n\t\t\t\t\tfont-family: Helvetica;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tcolor: rgba(255, 203, 62, 1);\r\n\r\n\t\t\t\t\t&::after {\r\n\t\t\t\t\t\tcontent: '';\r\n\t\t\t\t\t\tdisplay: block;\r\n\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\tbottom: 0;\r\n\t\t\t\t\t\tleft: 50%;\r\n\t\t\t\t\t\ttransform: translateX(-50%);\r\n\t\t\t\t\t\twidth: 67rpx;\r\n\t\t\t\t\t\theight: 4rpx;\r\n\t\t\t\t\t\tbackground: rgba(255, 203, 62, 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.desc {\r\n\t\t\t\t\tmargin-left: 165rpx;\r\n\r\n\t\t\t\t\t.title {\r\n\t\t\t\t\t\tmargin-top: 55rpx;\r\n\t\t\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\tcolor: rgba(51, 51, 50, 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.tips {\r\n\t\t\t\t\t\tmargin-top: 30rpx;\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tflex-flow: column;\r\n\r\n\t\t\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\t\tcolor: rgba(153, 152, 150, 1);\r\n\r\n\t\t\t\t\t\tview {\r\n\t\t\t\t\t\t\tmargin-bottom: 12rpx;\r\n\t\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.btn {\r\n\r\n\t\t\t\t\tdisplay: flex;\r\n\r\n\t\t\t\t\t.enable,\r\n\t\t\t\t\t.delete {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\theight: 60rpx;\r\n\t\t\t\t\t\twidth: 160rpx;\r\n\t\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\t\tbackground: rgba(255, 203, 62, 1);\r\n\t\t\t\t\t\tbox-shadow: 0px 4rpx 21rpx 0px rgba(255, 203, 62, 0.48);\r\n\t\t\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\t\tmargin-top: 40rpx;\r\n\t\t\t\t\t\tmargin-right: 45rpx;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.delete {\r\n\t\t\t\t\t\tbackground: #FA491D;\r\n\t\t\t\t\t\tbox-shadow: 0px 4px 21px 0px rgba(250, 73, 29, 0.48);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\timage {\r\n\t\t\t\t\t\twidth: 35rpx;\r\n\t\t\t\t\t\theight: 32rpx;\r\n\t\t\t\t\t\tpadding: 8rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\tmap {\r\n\t\t\theight: 100vh;\r\n\t\t\twidth: 750rpx;\r\n\t\t}\r\n\r\n\t\t// 新增按钮\r\n\t\t.add-fench {\r\n\t\t\tposition: fixed;\r\n\t\t\tright: 16rpx;\r\n\t\t\tz-index: 99;\r\n\t\t\tbottom: 150rpx;\r\n\r\n\t\t\timage {\r\n\t\t\t\twidth: 95rpx;\r\n\t\t\t\theight: 95rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.phcolor {\r\n\t\t\tcolor: #999996;\r\n;\r\n\t\t}\r\n\t\t\r\n\t\t// 保存按钮\r\n\t\t.save-fence{\r\n\t\t\tposition: fixed;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\tbottom: 70rpx;\r\n\t\t\tleft: 50%;\r\n\t\t\ttransform: translateX(-50%);\r\n\t\t\twidth: 420rpx;\r\n\t\t\theight: 88rpx;\r\n\t\t\tbox-shadow: 0px 8rpx 16rpx 0px rgba(239, 181, 22, 0.48);\r\n\t\t\tborder-radius: 44rpx;\r\n\t\t\tbackground: $base-color;\r\n\t\t}\r\n\r\n\t\t// 新增面板\r\n\t\t.add-panel {\r\n\t\t\tposition: fixed;\r\n\t\t\tpadding: 35rpx;\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\tmargin: auto;\r\n\t\t\ttop: 20rpx;\r\n\t\t\tz-index: 99;\r\n\t\t\twidth: 718rpx;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tbackground: rgba(255, 255, 255, 1);\r\n\t\t\tbox-shadow: 0px 1rpx 23rpx 1rpx rgba(36, 36, 35, 0.08);\r\n\t\t\tborder-radius: 30rpx;\r\n\r\n\t\t\t.title {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tbackground: rgba(255, 0, 42, 0);\r\n\t\t\t\tborder: 1rpx solid rgba(203, 203, 203, 1);\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tborder-radius: 3rpx;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\r\n\r\n\t\t\t\tinput {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t\tpadding: 0 20rpx;\r\n\t\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.type {\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\r\n\t\t\t\t.warn-type,\r\n\t\t\t\t.remind-type {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\tpadding: 0 20rpx;\r\n\t\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\t\twidth: 300rpx;\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tborder: 1rpx solid rgba(203, 203, 203, 1);\r\n\t\t\t\t\tborder-radius: 3rpx;\r\n\t\t\t\t\tcolor: rgba(153, 153, 150, 1);\r\n\t\t\t\t\tfont-size:30rpx;\r\n\r\n\t\t\t\t\timage {\r\n\t\t\t\t\t\twidth: 30rpx;\r\n\t\t\t\t\t\theight: 38rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./fence.vue?vue&type=style&index=0&id=98bf492c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./fence.vue?vue&type=style&index=0&id=98bf492c&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1597973027465\n      var cssReload = require(\"C:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}