(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sosDetail/sosDetail"],{3632:function(t,e,n){"use strict";var o;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}));var r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.sosTypeMap.get(t.sosInfo.sosType));t.$mp.data=Object.assign({},{$root:{g0:n}})},a=[]},"549d":function(t,e,n){"use strict";n.r(e);var o=n("de82"),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},b0e6:function(t,e,n){"use strict";n.r(e);var o=n("3632"),r=n("549d");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("bd0c");var i,c=n("f0c5"),u=Object(c["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);e["default"]=u.exports},bd0c:function(t,e,n){"use strict";var o=n("ffbf"),r=n.n(o);r.a},dbcc:function(t,e,n){"use strict";(function(t){n("6965");o(n("66fd"));var e=o(n("b0e6"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},de82:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=u(n("a34a")),r=u(n("73a2")),a=n("487b"),i=u(n("b8ca")),c=n("f6f9");function u(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e,n,o,r,a,i){try{var c=t[a](i),u=c.value}catch(s){return void n(s)}c.done?e(u):Promise.resolve(u).then(o,r)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function i(t){d(a,o,r,i,c,"next",t)}function c(t){d(a,o,r,i,c,"throw",t)}i(void 0)}))}}var h={onLoad:function(e){var n=this,o=t.createSelectorQuery().in(this);o.select(".panel").boundingClientRect((function(t){n.mapHeight=t.height})).exec(),this.getSOSLocation(e.id)},data:function(){return{longitude:"",latitude:"",sosInfo:{},sosTypeMap:new Map([[0,"紧急语音"],[1,"网络视频"],[2,"导游电话"],[3,"景区电话"]]),markers:[],polyline:[],includePoints:[],touristLocal:[],mapHeight:0}},methods:{getSOSLocation:function(e){var n=this;return p(o.default.mark((function u(){var s,f;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,(0,c.querySingleSos)({sosId:e});case 2:s=o.sent,f=s.value,n.sosInfo=f,n.touristLocal=[f.lat,f.lon],t.getLocation({type:"gcj02",success:function(e){var o=e.latitude,c=e.longitude,u=(0,a.getLatLngCenter)([i.default.transform([n.touristLocal[0],n.touristLocal[1]],i.default.BD09,i.default.GCJ02),[o,c]]);n.longitude=u[1],n.latitude=u[0];var s=i.default.transform([n.touristLocal[1],n.touristLocal[0]],i.default.BD09,i.default.GCJ02),f={longitude:s[0],latitude:s[1]},d={longitude:c,latitude:o},p=t.createMapContext("map");p.includePoints({points:[f,d],padding:[100,100,100,100],success:function(e){var o=new r.default({key:"56LBZ-OKVCW-TP3RL-RVH7P-RDRIQ-4EB2T"});o.direction({mode:"walking",from:d,to:f,fail:function(e){t.showToast({icon:"none",title:"起终点距离过长"})},success:function(t){for(var e,o=t.result.routes[0].distance,r=t.result.routes[0].polyline,a=[],i=1e6,c=2;c<r.length;c++)r[c]=Number(r[c-2])+Number(r[c])/i;for(var u=0;u<r.length;u+=2)a.push({latitude:r[u],longitude:r[u+1]});n.polyline=[{points:a,color:"#74C0F7",width:5}];var s=l(l({},d),{},{height:44,iconPath:"/static/guide2.png",id:0,width:32,label:{content:"我",anchorX:-8},callout:{content:"距离您当前位置".concat(o,"m"),borderRadius:18,borderColor:"#FFCE0B",padding:6,display:"ALWAYS",borderWidth:1}}),p=l(l({},f),{},{height:44,iconPath:"/static/youke@2x.png",id:0,width:32,label:{content:"游客",anchorX:-12}});(e=n.markers).push.apply(e,[s,p])}})}})}});case 7:case"end":return o.stop()}}),u)})))()},navigation:function(t){var e=i.default.transform([this.touristLocal[1],this.touristLocal[0]],i.default.BD09,i.default.GCJ02),n={longitude:e[0],latitude:e[1]};wx.openLocation(l(l({},n),{},{name:"游客".concat(t,"的求救位置"),address:"",scale:18}))},reslove:function(){var e=this;1!==this.sosInfo.isConfirm&&t.showModal({content:"请确认该条SOS信息是否已经被处理",success:function(){var n=p(o.default.mark((function n(r){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!r.confirm){n.next=13;break}return n.prev=1,n.next=4,(0,c.sosResolve)({sosId:e.sosInfo.id});case 4:n.sent,t.showToast({icon:"none",title:"已成功处理"}),t.navigateBack(),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](1),console.log(n.t0),t.showToast({icon:"none",title:"处理失败"});case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));function r(t){return n.apply(this,arguments)}return r}()})}}};e.default=h}).call(this,n("543d")["default"])},ffbf:function(t,e,n){}},[["dbcc","common/runtime","common/vendor"]]]);